{"ast":null,"code":"import _regeneratorRuntime from \"C:/Users/dgaidar/Documents/VScode/React/FoodOrderingSite/node_modules/@babel/runtime/regenerator\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport _asyncToGenerator from \"C:/Users/dgaidar/Documents/VScode/React/FoodOrderingSite/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\n\nvar _jsxFileName = \"C:\\\\Users\\\\dgaidar\\\\Documents\\\\VScode\\\\React\\\\FoodOrderingSite\\\\pages\\\\AllRestaurants\\\\[businessId]\\\\index.js\",\n    _this = this,\n    _s = $RefreshSig$();\n\nimport DetailCard from \"../../../components/Card/DetailCard\";\nimport { Fragment, useContext } from \"react\";\nimport AuthContext from \"../../../components/store/use-context\";\nimport { useRouter } from \"next/router\";\nimport { useEffect, useState } from \"react\";\nimport Image from \"../../../components/Details/image\";\nimport Details from '../../../components/Details/Details';\nimport Menu from \"../../../components/Details/Menu\";\nimport ItemCard from \"../../../components/Card/ItemCard\";\nimport ModalCart from \"../../../components/Cart/ModalCart\";\nimport ReviewPage from \"../../../components/Details/ReviewPage\";\n\nvar businessDetails = function businessDetails(props) {\n  _s();\n\n  function addReviewHandler(_x) {\n    return _addReviewHandler.apply(this, arguments);\n  }\n\n  function _addReviewHandler() {\n    _addReviewHandler = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(enteredItemData) {\n      var response, data;\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              _context.next = 2;\n              return fetch('../api/ReviewHandler', {\n                method: 'POST',\n                body: JSON.stringify({\n                  subject: enteredItemData.subject,\n                  body: enteredItemData.body,\n                  date: enteredItemData.date,\n                  stars: enteredItemData.stars,\n                  restaurant: a === null || a === void 0 ? void 0 : a.id,\n                  user: authCtx.user\n                }),\n                headers: {\n                  'Content-Type': 'application/json'\n                }\n              });\n\n            case 2:\n              response = _context.sent;\n              _context.next = 5;\n              return response.json();\n\n            case 5:\n              data = _context.sent;\n\n            case 6:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee);\n    }));\n    return _addReviewHandler.apply(this, arguments);\n  }\n\n  var authCtx = useContext(AuthContext);\n\n  var _useState = useState([]),\n      a = _useState[0],\n      setA = _useState[1];\n\n  var router = useRouter();\n  console.log(authCtx.menu);\n  console.log(authCtx);\n  var currMenu = authCtx.menu;\n  console.log('props', props);\n  console.log(currMenu);\n  console.log(router);\n\n  if (props.restaurant) {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        marginLeft: '8vw',\n        marginRight: '8vw',\n        marginBottom: '10vw'\n      },\n      children: [/*#__PURE__*/_jsxDEV(DetailCard, {\n        children: /*#__PURE__*/_jsxDEV(Image, {\n          image: props.restaurant.image,\n          details: props.restaurant.name,\n          subtitle: props.restaurant.description\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 48,\n          columnNumber: 21\n        }, _this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 48,\n        columnNumber: 9\n      }, _this), /*#__PURE__*/_jsxDEV(DetailCard, {\n        children: /*#__PURE__*/_jsxDEV(Details, {\n          description: props.restaurant.paragraph\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 49,\n          columnNumber: 21\n        }, _this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 49,\n        columnNumber: 9\n      }, _this), /*#__PURE__*/_jsxDEV(ItemCard, {\n        children: /*#__PURE__*/_jsxDEV(Menu, {\n          menu: props.restaurant.menu\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 50,\n          columnNumber: 19\n        }, _this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 50,\n        columnNumber: 9\n      }, _this), /*#__PURE__*/_jsxDEV(ItemCard, {\n        children: /*#__PURE__*/_jsxDEV(ReviewPage, {\n          addReviewHandler: addReviewHandler,\n          reviewList: props.reviews\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 51,\n          columnNumber: 19\n        }, _this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 51,\n        columnNumber: 9\n      }, _this), authCtx.isOpen && /*#__PURE__*/_jsxDEV(ModalCart, {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 52,\n        columnNumber: 28\n      }, _this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 46,\n      columnNumber: 12\n    }, _this);\n  } else {\n    return /*#__PURE__*/_jsxDEV(\"div\", {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 56,\n      columnNumber: 16\n    }, _this);\n  }\n};\n\n_s(businessDetails, \"qA2hAFd+1cXPAkKZas3Sr2fzi3o=\", false, function () {\n  return [useRouter];\n});\n\nexport var __N_SSG = true;\nexport default businessDetails;","map":{"version":3,"sources":["C:/Users/dgaidar/Documents/VScode/React/FoodOrderingSite/pages/AllRestaurants/[businessId]/index.js"],"names":["DetailCard","Fragment","useContext","AuthContext","useRouter","useEffect","useState","Image","Details","Menu","ItemCard","ModalCart","ReviewPage","businessDetails","props","addReviewHandler","enteredItemData","fetch","method","body","JSON","stringify","subject","date","stars","restaurant","a","id","user","authCtx","headers","response","json","data","setA","router","console","log","menu","currMenu","marginLeft","marginRight","marginBottom","image","name","description","paragraph","reviews","isOpen"],"mappings":"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","sourcesContent":["\r\nimport DetailCard from \"../../../components/Card/DetailCard\";\r\nimport { Fragment, useContext } from \"react\";\r\nimport AuthContext from \"../../../components/store/use-context\";\r\nimport { useRouter } from \"next/router\";\r\nimport { useEffect, useState } from \"react\";\r\nimport Image from \"../../../components/Details/image\";\r\nimport Details from '../../../components/Details/Details';\r\nimport Menu from \"../../../components/Details/Menu\";\r\nimport ItemCard from \"../../../components/Card/ItemCard\";\r\nimport ModalCart from \"../../../components/Cart/ModalCart\";\r\nimport ReviewPage from \"../../../components/Details/ReviewPage\";\r\nimport { MongoClient, ObjectId, } from \"mongodb\";\r\n\r\nconst businessDetails = (props) => {\r\n    \r\n    async function addReviewHandler(enteredItemData) {\r\n        const response = await fetch('../api/ReviewHandler', {\r\n          method: 'POST',\r\n          body: JSON.stringify({\r\n            subject: enteredItemData.subject,\r\n            body: enteredItemData.body,\r\n            date: enteredItemData.date,\r\n            stars: enteredItemData.stars,\r\n            restaurant: a?.id,\r\n            user: authCtx.user\r\n          }),\r\n          headers: {\r\n            'Content-Type': 'application/json'\r\n          }\r\n        });\r\n    \r\n        const data = await response.json();\r\n        \r\n    }\r\n    const authCtx = useContext(AuthContext);\r\n    const [a, setA] = useState([]);\r\n    const router = useRouter();\r\n    console.log(authCtx.menu);\r\n    console.log(authCtx);\r\n    const currMenu = authCtx.menu;\r\n    console.log('props',props);\r\n    console.log(currMenu);\r\n    console.log(router);\r\n    if (props.restaurant){\r\n    return <div style = {{marginLeft: '8vw', marginRight: '8vw', marginBottom: '10vw'}}>\r\n\r\n        <DetailCard><Image image = {props.restaurant.image} details = {props.restaurant.name} subtitle = {props.restaurant.description}/></DetailCard>\r\n        <DetailCard><Details description = {props.restaurant.paragraph}/></DetailCard>\r\n        <ItemCard><Menu menu = {props.restaurant.menu}/></ItemCard>\r\n        <ItemCard><ReviewPage addReviewHandler = {addReviewHandler} reviewList = {props.reviews}/></ItemCard>\r\n        {authCtx.isOpen && <ModalCart/>}\r\n    </div>\r\n    }\r\n    else {\r\n        return <div></div>\r\n    }\r\n    \r\n}\r\nexport async function getStaticPaths() {\r\n    const client = await MongoClient.connect(\r\n      'mongodb+srv://dg21:2x9QUtNjUM3tuL6p@cluster0.nxpoghz.mongodb.net/FoodOrderingSite?retryWrites=true&w=majority'  );\r\n      const db = client.db();\r\n\r\n      const meetupsCollection = db.collection('reviewList');\r\n      console.log(meetupsCollection);\r\n      const meetups = await meetupsCollection.find({}, { restaurant: 1 }).toArray();\r\n   \r\n      client.close();\r\n    \r\n      return {\r\n        fallback: \"blocking\",\r\n        paths: meetups.map((meetup) => ({\r\n          params: { businessId: meetup._id.toString() },\r\n        })),\r\n      };\r\n  }\r\n  \r\n  export async function getStaticProps(context) {\r\n    // fetch data for a single meetup\r\n  \r\n    const meetupId = context.params.businessId;\r\n    console.log('meetupId',typeof meetupId);\r\n    const client = await MongoClient.connect(\r\n      'mongodb+srv://dg21:2x9QUtNjUM3tuL6p@cluster0.nxpoghz.mongodb.net/FoodOrderingSite?retryWrites=true&w=majority'  );\r\n    const db = client.db();\r\n  \r\n    const meetupsCollection = db.collection('reviewList');\r\n    const resCollection = db.collection('ResList');\r\n    const  review = await meetupsCollection.find({\r\n      restaurant: meetupId\r\n    }).toArray();\r\n    const res = await resCollection.findOne({\r\n        _id: ObjectId(meetupId)\r\n    })\r\n\r\n    client.close();\r\n  \r\n    return {\r\n      props: {\r\n        reviews: review.map(r => ({\r\n            user: r.user,\r\n            date: r.date,\r\n            id: r._id.toString(),\r\n            body: r.body,\r\n            subject: r.subject,\r\n            restaurant: r.restaurant,\r\n            stars: r.stars \r\n        })),\r\n        restaurant: {\r\n            name: res.name,\r\n            address: res.address,\r\n            image: res.image,\r\n            id: res._id.toString(),\r\n            description: res.description,\r\n            menu: res.menu,\r\n            paragraph: res.paragraph\r\n        }\r\n      },\r\n      revalidate: 10\r\n    };\r\n  }\r\n\r\n\r\nexport default businessDetails;"]},"metadata":{},"sourceType":"module"}
{"ast":null,"code":"import _regeneratorRuntime from \"C:/Users/gaida/Documents/React/FoodOrderingSite/node_modules/@babel/runtime/regenerator\";\nimport { jsxs as _jsxs } from \"react/jsx-runtime\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport _asyncToGenerator from \"C:/Users/gaida/Documents/React/FoodOrderingSite/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport { useContext, useEffect, useState } from \"react\";\nimport Card from \"../../../components/Card/Card\";\nimport SearchInfo from \"../../../components/Details/SearchInfo\";\nimport AuthContext from \"../../../components/store/use-context\";\nimport styles from '../../../components/Details/SearchInfo.module.css';\nimport Head from 'next/Head';\n\nvar search = function search() {\n  var authCtx = useContext(AuthContext);\n\n  var _useState = useState(null),\n      currSearch = _useState[0],\n      setCurrSearch = _useState[1];\n\n  var _useState2 = useState(1),\n      pageNum = _useState2[0],\n      setPageNum = _useState2[1];\n\n  var _useState3 = useState(false),\n      totalNum = _useState3[0],\n      setTotalNum = _useState3[1];\n\n  var _useState4 = useState(false),\n      isLoading = _useState4[0],\n      setIsLoading = _useState4[1];\n\n  var _useState5 = useState([]),\n      currData = _useState5[0],\n      setCurrData = _useState5[1];\n\n  var _useState6 = useState(null),\n      circArr = _useState6[0],\n      setCircArr = _useState6[1];\n\n  useEffect(function () {\n    var ressy = setTimeout(function () {\n      if (currSearch == null) {\n        setCurrSearch(authCtx.searchStr);\n        getter(authCtx.searchStr);\n      } else if (currSearch != '') {\n        getter(currSearch);\n        console.log('hello!', currSearch);\n        console.log(currData);\n      } else {\n        setCurrData([]);\n      }\n    }, 500);\n    return function () {\n      clearTimeout(ressy);\n    };\n  }, [currSearch]);\n\n  function getter(_x) {\n    return _getter.apply(this, arguments);\n  }\n\n  function _getter() {\n    _getter = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(value) {\n      var _data$0$totalRecords$;\n\n      var enteredIndex,\n          response,\n          data,\n          _args = arguments;\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              enteredIndex = _args.length > 1 && _args[1] !== undefined ? _args[1] : 1;\n              setIsLoading(true);\n              _context.next = 4;\n              return fetch(\"../api/getResListHandler?name=\".concat(value, \"&pageIndex=\").concat(enteredIndex, \"&pageSize=3\"), {\n                method: 'GET'\n              });\n\n            case 4:\n              response = _context.sent;\n              _context.next = 7;\n              return response.json();\n\n            case 7:\n              data = _context.sent;\n              setIsLoading(false);\n              setCurrData(data[0].data);\n              console.log(data);\n              setTotalNum(data[0].totalRecords[0] ? parseInt((_data$0$totalRecords$ = data[0].totalRecords[0]) === null || _data$0$totalRecords$ === void 0 ? void 0 : _data$0$totalRecords$.description) : 1);\n\n            case 12:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee);\n    }));\n    return _getter.apply(this, arguments);\n  }\n\n  var plus = function plus() {\n    setPageNum(function (prevVal) {\n      if (totalNum / 2 > prevVal) {\n        console.log(totalNum);\n        prevVal++;\n        getter(currSearch, prevVal);\n      }\n\n      console.log(prevVal);\n      return prevVal;\n    });\n  };\n\n  var minus = function minus() {\n    setPageNum(function (prevVal) {\n      if (prevVal > 1) {\n        prevVal--;\n        getter(currSearch, prevVal);\n      }\n\n      return prevVal;\n    });\n  };\n\n  useEffect(function () {\n    if (totalNum) {\n      setCircArr(function (prevVal) {\n        prevVal = [];\n        console.log(totalNum / 2);\n\n        while (prevVal.length < parseInt(totalNum / 2)) {\n          if (prevVal.length == pageNum - 1) {\n            prevVal.push( /*#__PURE__*/_jsx(\"span\", {\n              className: styles.selectedBtn,\n              children: \"  \\u25CF\"\n            }));\n          } else {\n            prevVal.push( /*#__PURE__*/_jsx(\"span\", {\n              style: {\n                color: '#797979'\n              },\n              children: \" \\u25CF\"\n            }));\n          }\n        }\n\n        return prevVal;\n      });\n    }\n  }, [totalNum, pageNum]);\n\n  var changeHandler = function changeHandler(e) {\n    setPageNum(1);\n    setCurrSearch(e.target.value);\n  };\n\n  return /*#__PURE__*/_jsxs(Card, {\n    children: [/*#__PURE__*/_jsx(Head, {\n      children: /*#__PURE__*/_jsx(\"title\", {\n        children: \"Search\"\n      })\n    }), /*#__PURE__*/_jsx(\"h2\", {\n      className: styles.name,\n      children: \"Search\"\n    }), /*#__PURE__*/_jsx(\"input\", {\n      placeHolder: \"search for business!\",\n      onInput: changeHandler,\n      className: styles.input,\n      value: currSearch\n    }), !isLoading && currData != '' && /*#__PURE__*/_jsx(\"div\", {\n      className: styles.name,\n      style: {\n        color: 'rgba(0,0,0,0.8)'\n      },\n      children: \" Search Results: \"\n    }), /*#__PURE__*/_jsx(\"hr\", {}), isLoading && /*#__PURE__*/_jsx(\"h2\", {\n      className: styles.name,\n      children: \"Searching for Restaurants...\"\n    }), !isLoading && /*#__PURE__*/_jsxs(\"div\", {\n      children: [/*#__PURE__*/_jsx(\"div\", {\n        children: currData.map(function (key) {\n          return /*#__PURE__*/_jsx(SearchInfo, {\n            name: key.name,\n            id: key.id,\n            image: key.image,\n            address: key.address,\n            description: key.description,\n            isLoading: isLoading\n          }, key.id);\n        })\n      }), /*#__PURE__*/_jsx(\"div\", {\n        children: circArr\n      }), pageNum != 1 && /*#__PURE__*/_jsx(\"button\", {\n        className: styles.nextBtn,\n        onClick: minus,\n        children: \"previous\"\n      }), pageNum < totalNum / 2 && /*#__PURE__*/_jsx(\"button\", {\n        className: styles.nextBtn,\n        onClick: plus,\n        children: \"next\"\n      })]\n    })]\n  });\n};\n\nexport default search;","map":null,"metadata":{},"sourceType":"module"}
{"ast":null,"code":"import _regeneratorRuntime from \"C:/Users/gaida/Documents/React/FoodOrderingSite/node_modules/@babel/runtime/regenerator\";\nimport { jsxs as _jsxs } from \"react/jsx-runtime\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport _asyncToGenerator from \"C:/Users/gaida/Documents/React/FoodOrderingSite/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport DetailCard from \"../../../components/Card/DetailCard\";\nimport { useContext, useSearchParams, useState, useEffect } from \"react\";\nimport AuthContext from \"../../../components/store/use-context\";\nimport Image from \"../../../components/Details/image\";\nimport Details from '../../../components/Details/Details';\nimport Menu from \"../../../components/Details/Menu\";\nimport ItemCard from \"../../../components/Card/ItemCard\";\nimport ModalCart from \"../../../components/Cart/ModalCart\";\nimport ReviewPage from \"../../../components/Details/ReviewPage\";\nimport Head from \"next/head\";\n\nvar businessDetails = function businessDetails(props) {\n  var _props$restaurant, _props$restaurant2, _props$restaurant3, _props$restaurant4, _props$restaurant5, _props$restaurant6;\n\n  var _useState = useState(1),\n      pageNum = _useState[0],\n      setPageNum = _useState[1];\n\n  var _useState2 = useState(null),\n      totalNum = _useState2[0],\n      setTotalNum = _useState2[1];\n\n  var _useState3 = useState([]),\n      reviewList = _useState3[0],\n      setReviewList = _useState3[1];\n\n  var _useState4 = useState(false),\n      isLoading = _useState4[0],\n      setIsLoading = _useState4[1];\n\n  function getter() {\n    return _getter.apply(this, arguments);\n  }\n\n  function _getter() {\n    _getter = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee() {\n      var enteredItemData,\n          response,\n          data,\n          _data$0$totalRecords$,\n          _args = arguments;\n\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              enteredItemData = _args.length > 0 && _args[0] !== undefined ? _args[0] : 1;\n              setIsLoading(true);\n              _context.next = 4;\n              return fetch(\"../api/getHandler?pageIndex=\".concat(enteredItemData, \"&pageSize=2&restaurantURL=\").concat(window.location.pathname), {\n                method: 'GET'\n              });\n\n            case 4:\n              response = _context.sent;\n              _context.next = 7;\n              return response.json();\n\n            case 7:\n              data = _context.sent;\n              setIsLoading(false);\n\n              if (!totalNum) {\n                setTotalNum(data[0].totalRecords[0] ? parseInt((_data$0$totalRecords$ = data[0].totalRecords[0]) === null || _data$0$totalRecords$ === void 0 ? void 0 : _data$0$totalRecords$.body) : 1);\n              }\n\n              setReviewList(data[0].data);\n\n            case 11:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee);\n    }));\n    return _getter.apply(this, arguments);\n  }\n\n  useEffect(function () {\n    getter();\n  }, []);\n\n  var plus = function plus() {\n    setPageNum(function (prevVal) {\n      if (totalNum / 2 > prevVal) {\n        prevVal++;\n        getter(prevVal);\n      }\n\n      return prevVal;\n    });\n  };\n\n  var minus = function minus() {\n    setPageNum(function (prevVal) {\n      if (prevVal > 1) {\n        prevVal--;\n        getter(prevVal);\n      }\n\n      return prevVal;\n    });\n  };\n\n  function addReviewHandler(_x) {\n    return _addReviewHandler.apply(this, arguments);\n  }\n\n  function _addReviewHandler() {\n    _addReviewHandler = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2(enteredItemData) {\n      var response, data;\n      return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n        while (1) {\n          switch (_context2.prev = _context2.next) {\n            case 0:\n              _context2.next = 2;\n              return fetch('../api/ReviewHandler', {\n                method: 'POST',\n                body: JSON.stringify({\n                  subject: enteredItemData.subject,\n                  body: enteredItemData.body,\n                  date: enteredItemData.date,\n                  stars: enteredItemData.stars,\n                  restaurant: props.restaurant.id,\n                  user: authCtx.user\n                }),\n                headers: {\n                  'Content-Type': 'application/json'\n                }\n              });\n\n            case 2:\n              response = _context2.sent;\n              _context2.next = 5;\n              return response.json();\n\n            case 5:\n              data = _context2.sent;\n\n            case 6:\n            case \"end\":\n              return _context2.stop();\n          }\n        }\n      }, _callee2);\n    }));\n    return _addReviewHandler.apply(this, arguments);\n  }\n\n  var authCtx = useContext(AuthContext);\n  return /*#__PURE__*/_jsxs(\"div\", {\n    style: {\n      marginLeft: '8vw',\n      marginRight: '8vw',\n      marginBottom: '10vw'\n    },\n    children: [/*#__PURE__*/_jsx(Head, {\n      children: /*#__PURE__*/_jsx(\"title\", {\n        children: (_props$restaurant = props.restaurant) === null || _props$restaurant === void 0 ? void 0 : _props$restaurant.name\n      })\n    }), /*#__PURE__*/_jsx(DetailCard, {\n      children: /*#__PURE__*/_jsx(Image, {\n        image: (_props$restaurant2 = props.restaurant) === null || _props$restaurant2 === void 0 ? void 0 : _props$restaurant2.image,\n        details: (_props$restaurant3 = props.restaurant) === null || _props$restaurant3 === void 0 ? void 0 : _props$restaurant3.name,\n        subtitle: (_props$restaurant4 = props.restaurant) === null || _props$restaurant4 === void 0 ? void 0 : _props$restaurant4.description\n      })\n    }), /*#__PURE__*/_jsx(DetailCard, {\n      children: /*#__PURE__*/_jsx(Details, {\n        description: (_props$restaurant5 = props.restaurant) === null || _props$restaurant5 === void 0 ? void 0 : _props$restaurant5.paragraph\n      })\n    }), /*#__PURE__*/_jsx(ItemCard, {\n      children: /*#__PURE__*/_jsx(Menu, {\n        menu: (_props$restaurant6 = props.restaurant) === null || _props$restaurant6 === void 0 ? void 0 : _props$restaurant6.menu\n      })\n    }), /*#__PURE__*/_jsx(ItemCard, {\n      children: /*#__PURE__*/_jsx(ReviewPage, {\n        addReviewHandler: addReviewHandler,\n        total: totalNum,\n        isLoading: isLoading,\n        getter: getter,\n        pageNum: pageNum,\n        reviewList: reviewList,\n        plus: plus,\n        minus: minus\n      })\n    }), authCtx.isOpen && /*#__PURE__*/_jsx(ModalCart, {})]\n  });\n};\n\nexport var __N_SSG = true;\nexport default businessDetails;","map":null,"metadata":{},"sourceType":"module"}
{"ast":null,"code":"import { MongoClient } from 'mongodb';\n\nasync function getHandler(req, res) {\n  if (req.method === 'GET') {\n    const data = req.body;\n    console.log(req.query.pageIndex);\n    const page = req.query.pageIndex ? parseInt(req.query.pageIndex) : 1;\n    const limit = req.query.pageSize ? parseInt(req.query.pageSize) : 2;\n    const currURLLimiter = req.query.restaurantURL.slice(16);\n    const skip = (page - 1) * limit;\n    console.log(currURLLimiter);\n    const client = await MongoClient.connect('mongodb+srv://dg21:2x9QUtNjUM3tuL6p@cluster0.nxpoghz.mongodb.net/FoodOrderingSite?retryWrites=true&w=majority');\n    const db = client.db();\n    const meetupsCollection = db.collection('reviewList');\n    const result = await meetupsCollection.aggregate([{\n      $sort: {\n        date: -1\n      }\n    }, {\n      $facet: {\n        totalRecords: [{\n          $match: {\n            restaurant: currURLLimiter\n          }\n        }, {\n          $count: 'body'\n        }],\n        data: [{\n          $match: {\n            restaurant: currURLLimiter\n          }\n        }, {\n          $skip: skip\n        }, {\n          $limit: limit\n        }]\n      }\n    }]).toArray();\n    client.close();\n    res.send(result);\n  }\n}\n\n;\nexport default getHandler;","map":null,"metadata":{},"sourceType":"module"}